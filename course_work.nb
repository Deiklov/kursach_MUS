(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30618,        820]
NotebookOptionsPosition[     28210,        769]
NotebookOutlinePosition[     28714,        787]
CellTagsIndexPosition[     28671,        784]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Calculate 1 stage, initial condition from start state", "Subsection",
 CellChangeTimes->{{3.855550172677368*^9, 3.855550183949669*^9}, {
   3.855550300810872*^9, 3.855550457399312*^9}, {3.855550535134934*^9, 
   3.855550539982279*^9}, {3.855550583407797*^9, 3.8555505856823874`*^9}, 
   3.855550643261456*^9, 3.855628513667968*^9, {3.8556286489549303`*^9, 
   3.855628656268599*^9}, {3.8556290338043957`*^9, 3.8556290569029827`*^9}, 
   3.8556291247229433`*^9, {3.855629408583091*^9, 3.8556294216632137`*^9}},
 FontSize->18,ExpressionUUID->"461778f0-a5fe-4d24-b761-1aa424940857"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", "all", "]"}], "\[IndentingNewLine]", 
 RowBox[{"sol1", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"DSolve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["theta", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "\[Equal]", 
         RowBox[{"omega", "[", "x", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["omega", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"m", "[", "x", "]"}], "+", 
          RowBox[{"theta", "[", "x", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["m", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "\[Equal]", "u"}], ",", 
        
        RowBox[{
         RowBox[{"theta", "[", "0", "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{
         RowBox[{"omega", "[", "0", "]"}], "\[Equal]", "Om0"}], ",", 
        RowBox[{
         RowBox[{"m", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta", "[", "x", "]"}], ",", 
        RowBox[{"omega", "[", "x", "]"}], ",", 
        RowBox[{"m", "[", "x", "]"}]}], "}"}], ",", "x"}], "]"}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.855550788069735*^9, 3.855550788070203*^9}, {
   3.855551518159266*^9, 3.8555515404240313`*^9}, {3.855551805123687*^9, 
   3.8555518160326853`*^9}, {3.855551919701412*^9, 3.855552012396834*^9}, {
   3.855552231453973*^9, 3.855552370064603*^9}, {3.855552472898848*^9, 
   3.855552592048266*^9}, {3.85555262631257*^9, 3.855552665941855*^9}, {
   3.8555527227677717`*^9, 3.855552856663974*^9}, {3.855552891449134*^9, 
   3.855553112708529*^9}, {3.855553208451857*^9, 3.8555532100209017`*^9}, {
   3.855553410948106*^9, 3.855553524188715*^9}, {3.855553595584537*^9, 
   3.855553705411175*^9}, {3.85555406592417*^9, 3.8555540698593473`*^9}, {
   3.855554100996439*^9, 3.855554126039798*^9}, {3.85555415735688*^9, 
   3.855554174595492*^9}, {3.855554228108753*^9, 3.855554269485865*^9}, {
   3.855554521216761*^9, 3.855554521480248*^9}, {3.855554601790696*^9, 
   3.855554606954309*^9}, {3.855554671843645*^9, 3.855554678271717*^9}, {
   3.8555549175501127`*^9, 3.855554918108984*^9}, {3.855568949189969*^9, 
   3.85556895495986*^9}, {3.855628666501253*^9, 3.85562869261305*^9}, {
   3.8556287289678307`*^9, 3.855628758145899*^9}, 3.855628828825224*^9, {
   3.855629568349475*^9, 3.855629568842964*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"cd5c42cf-cee7-4867-857a-29bf95eb264f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"m", "[", "x", "]"}], "\[Rule]", 
    RowBox[{"u", " ", "x"}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "x", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", "x"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "Om0", "+", "u", "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", "x"], " ", "u"}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "x"}]], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "Om0", "+", "u"}], ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"theta", "[", "x", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", "x"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "Om0", "-", "u", "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", "x"}]], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "Om0", "+", "u"}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[ExponentialE]", "x"], " ", "u", " ", "x"}]}], 
      ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8555515237883472`*^9, 3.855551545478032*^9}, 
   3.855551823768601*^9, 3.855552382251446*^9, {3.855552475384761*^9, 
   3.855552496624752*^9}, 3.855552529931466*^9, 3.855552596268067*^9, {
   3.855552642384365*^9, 3.855552675238193*^9}, {3.8555527314224977`*^9, 
   3.855552859180092*^9}, 3.855552985454439*^9, {3.855553015794257*^9, 
   3.85555302883506*^9}, {3.855553065734207*^9, 3.8555531167422047`*^9}, 
   3.855553213141653*^9, 3.855553624629458*^9, {3.855553675257792*^9, 
   3.855553708131378*^9}, {3.855554113394953*^9, 3.855554120722842*^9}, 
   3.855554181756928*^9, 3.8555542741223907`*^9, 3.8555546312154503`*^9, 
   3.855554681185484*^9, 3.855554991544778*^9, {3.855568945121828*^9, 
   3.855568957592332*^9}, {3.855628681251073*^9, 3.855628760788457*^9}, 
   3.855628872115325*^9, 3.855629573088366*^9},
 CellLabel->
  "Out[157]=",ExpressionUUID->"213b9ab9-98c6-4776-a467-1035a0033488"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"initForStage2", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"m", "[", "x", "]"}], "/.", 
      RowBox[{
      "sol1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "/.", 
     
     RowBox[{"x", "->", "t1"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"omega", "[", "x", "]"}], "/.", 
      RowBox[{
      "sol1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "/.", 
     
     RowBox[{"x", "->", "t1"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"theta", "[", "x", "]"}], "/.", 
      RowBox[{
      "sol1", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "/.", 
     
     RowBox[{"x", "->", "t1"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8556288476647987`*^9, 3.85562893242341*^9}, {
   3.8556289722454453`*^9, 3.855628982560588*^9}, {3.8556291834566298`*^9, 
   3.855629185662138*^9}, 3.855629482051736*^9},
 CellLabel->
  "In[154]:=",ExpressionUUID->"777838e7-968a-4783-9ec0-a799c687cf0f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"t1", " ", "u"}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "t1"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "Om0", "+", "u", "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", "t1"], " ", "u"}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "t1"}]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "Om0", "+", "u"}], ")"}]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "t1"}]], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", "Om0", "-", "u", "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", "t1"], " ", "t1", " ", "u"}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", "t1"}]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "Om0", "+", "u"}], ")"}]}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.855628867567986*^9, 3.855628905415979*^9}, 
   3.855628988643262*^9, 3.855629187951435*^9, 3.855629485769603*^9},
 CellLabel->
  "Out[154]=",ExpressionUUID->"dc89247c-0ef0-49b6-825a-e10583d5334e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculate 2 stage, initial condition from initForStage2, control U=-u\
\>", "Subsection",
 CellChangeTimes->{{3.855628939751362*^9, 3.85562895148801*^9}, {
   3.855628985072801*^9, 3.855629031164301*^9}, {3.855629063897381*^9, 
   3.855629079390476*^9}, 3.855629127956791*^9, {3.855629602911515*^9, 
   3.855629611857834*^9}},ExpressionUUID->"fac48f80-e163-4ab5-ad36-\
365c614d5e30"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol2", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"DSolve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["theta", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "\[Equal]", 
         RowBox[{"omega", "[", "x", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["omega", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"m", "[", "x", "]"}], "+", 
          RowBox[{"theta", "[", "x", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["m", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "\[Equal]", 
         RowBox[{"-", "u"}]}], ",", 
        RowBox[{
         RowBox[{"theta", "[", "t1", "]"}], "\[Equal]", 
         RowBox[{"initForStage2", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"omega", "[", "t1", "]"}], "\[Equal]", 
         RowBox[{"initForStage2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"m", "[", "t1", "]"}], "\[Equal]", 
         RowBox[{"initForStage2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta", "[", "x", "]"}], ",", 
        RowBox[{"omega", "[", "x", "]"}], ",", 
        RowBox[{"m", "[", "x", "]"}]}], "}"}], ",", "x"}], "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.855554898636307*^9, 3.855555004632461*^9}, {
   3.855555043777772*^9, 3.855555058073638*^9}, {3.855555095498954*^9, 
   3.855555182120414*^9}, {3.855555281260067*^9, 3.855555294799337*^9}, {
   3.855569413715768*^9, 3.855569449416644*^9}, 3.855569511815608*^9, {
   3.8555704110964317`*^9, 3.855570495021501*^9}, {3.855629003825212*^9, 
   3.855629003862965*^9}, {3.855629217293376*^9, 3.855629283624072*^9}, 
   3.855629330914638*^9},
 CellLabel->
  "In[153]:=",ExpressionUUID->"9b3a5a6d-b49a-44e4-b2a4-a8fb8e9241ed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"m", "[", "x", "]"}], "\[Rule]", 
    RowBox[{"u", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "t1"}], "-", "x"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "x", "]"}], "\[Rule]", 
    RowBox[{"u", "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"t1", "-", "x"}]], " ", "u"}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "t1"}], "+", "x"}]], " ", "u"}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "Om0", "+", "u"}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "Om0", "+", "u"}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta", "[", "x", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"t1", "-", "x"}]], " ", "u"}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "t1"}], "+", "x"}]], " ", "u"}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", "x"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "Om0", "+", "u"}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox["\[ExponentialE]", "x"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "Om0", "+", "u"}], ")"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "t1"}], "+", "x"}], ")"}]}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.855555297003272*^9, {3.8555694254398203`*^9, 3.855569452091343*^9}, 
   3.855569514247418*^9, 3.8555705125114403`*^9, {3.8556292587582817`*^9, 
   3.855629287155148*^9}, 3.8556294452548513`*^9},
 CellLabel->
  "Out[153]=",ExpressionUUID->"aa8b1169-78b9-45db-bff3-1e9ae0878642"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"t1", "-", "x"}]], " ", "u"}], "-", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "t1"}], "+", "x"}]], " ", "u"}], "-", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "x"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "Om0", "+", "u"}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    SuperscriptBox["\[ExponentialE]", "x"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "Om0", "+", "u"}], ")"}]}], "+", 
   RowBox[{"u", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "t1"}], "+", "x"}], ")"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.855645108978125*^9, 3.8556451238906*^9}, 
   3.8556452755306377`*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"adbc8ed6-3a92-42a3-8833-19696b0688f6"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "x"}]], "2"], "+", 
   FractionBox[
    SuperscriptBox["\[ExponentialE]", "x"], "2"], "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", "x"}]], " ", "Om0"}], "2"], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "x"], " ", "Om0"}], "2"], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"t1", "-", "x"}]], " ", "u"}], "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", "x"}]], " ", "u"}], "2"], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "x"], " ", "u"}], "2"], "-", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "t1"}], "+", "x"}]], " ", "u"}], "-", 
   RowBox[{"2", " ", "t1", " ", "u"}], "+", 
   RowBox[{"u", " ", "x"}]}],
  FontSize->18]], "Input",
 CellChangeTimes->{3.8556452924426537`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"9ab78482-05ec-47a7-8da0-83665b620c00"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate 3 stage, initial condition from final state", "Subsection",
 CellChangeTimes->{{3.8556293384900513`*^9, 3.855629351417039*^9}, {
  3.855629399825672*^9, 
  3.855629403163493*^9}},ExpressionUUID->"40a0242e-bc68-463b-ae15-\
092ddcf057d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol3", "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"DSolve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["theta", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "\[Equal]", 
         RowBox[{"omega", "[", "x", "]"}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["omega", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"m", "[", "x", "]"}], "+", 
          RowBox[{"theta", "[", "x", "]"}]}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["m", "\[Prime]",
           MultilineFunction->None], "[", "x", "]"}], "\[Equal]", "u"}], ",", 
        
        RowBox[{
         RowBox[{"theta", "[", "tf", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"omega", "[", "tf", "]"}], "\[Equal]", "0"}], ",", 
        RowBox[{
         RowBox[{"m", "[", "tf", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta", "[", "x", "]"}], ",", 
        RowBox[{"omega", "[", "x", "]"}], ",", 
        RowBox[{"m", "[", "x", "]"}]}], "}"}], ",", "x"}], "]"}], "]"}], "//",
    "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.8555715306095943`*^9, 3.855571585794318*^9}, {
  3.8555756078748293`*^9, 3.855575610934518*^9}, {3.855629594647336*^9, 
  3.8556295949950123`*^9}, {3.855630103000105*^9, 3.855630104983933*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"4b51e8c3-25cf-49b2-8857-4d1b39241487"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"m", "[", "x", "]"}], "\[Rule]", 
    RowBox[{"u", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "tf"}], "+", "x"}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "x", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "tf"}], "-", "x"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", "tf"], "-", 
        SuperscriptBox["\[ExponentialE]", "x"]}], ")"}], "2"], " ", "u"}]}], 
   ",", 
   RowBox[{
    RowBox[{"theta", "[", "x", "]"}], "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", "u", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"tf", "-", "x"}]]}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "tf"}], "+", "x"}]], "+", 
       RowBox[{"2", " ", "tf"}], "-", 
       RowBox[{"2", " ", "x"}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.855571588570059*^9, 3.855575925944385*^9, 
  3.8556295543592663`*^9, 3.855629598203665*^9, 3.85563010835367*^9},
 CellLabel->
  "Out[167]=",ExpressionUUID->"c887c275-a40a-47ed-8fe6-9f754d04a048"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Let\[CloseCurlyQuote]s find t1,t2,tf", "Subsection",
 CellChangeTimes->{{3.8556297564760838`*^9, 
  3.8556297757568197`*^9}},ExpressionUUID->"79891f49-26e2-41b8-abb7-\
da493c9e4a1c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"sol2WithT2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"m", "[", "x", "]"}], "/.", "\[VeryThinSpace]", 
          RowBox[{
          "sol2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "/.",
          "\[VeryThinSpace]", 
         RowBox[{"x", "\[Rule]", "t2"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"omega", "[", "x", "]"}], "/.", "\[VeryThinSpace]", 
          RowBox[{
          "sol2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "/.",
          "\[VeryThinSpace]", 
         RowBox[{"x", "\[Rule]", "t2"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"theta", "[", "x", "]"}], "/.", "\[VeryThinSpace]", 
          RowBox[{
          "sol2", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "/.",
          "\[VeryThinSpace]", 
         RowBox[{"x", "\[Rule]", "t2"}]}]}], "}"}], "\n", "sol3WithT2"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"m", "[", "x", "]"}], "/.", "\[VeryThinSpace]", 
         RowBox[{
         "sol3", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "/.",
         "\[VeryThinSpace]", 
        RowBox[{"x", "\[Rule]", "t2"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"omega", "[", "x", "]"}], "/.", "\[VeryThinSpace]", 
         RowBox[{
         "sol3", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "/.",
         "\[VeryThinSpace]", 
        RowBox[{"x", "\[Rule]", "t2"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"theta", "[", "x", "]"}], "/.", "\[VeryThinSpace]", 
         RowBox[{
         "sol3", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], "/.",
         "\[VeryThinSpace]", 
        RowBox[{"x", "\[Rule]", "t2"}]}]}], "}"}]}]}], "*)"}], "\n", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"NSolve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"z", "\[Equal]", 
         FractionBox["y", "x"]}], "&&", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", "u", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["y", 
             SuperscriptBox["z", "2"]], "-", 
            FractionBox[
             SuperscriptBox["z", "2"], "y"]}], ")"}]}], "\[Equal]", 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"x", "-", 
             FractionBox["1", "x"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "w"}], ")"}]}], "-", 
          RowBox[{"u", " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["y", "x"], "-", 
             FractionBox["x", "y"]}], ")"}]}], "+", 
          RowBox[{
           FractionBox["1", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"x", "+", 
             FractionBox["1", "x"]}], ")"}]}]}]}], "&&", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", "u", " ", 
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox["z", "2"], "y"], "+", 
            FractionBox["y", 
             SuperscriptBox["z", "2"]]}], ")"}]}], "-", 
         RowBox[{"2", " ", "u"}]}]}], "=", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"x", "+", 
           FractionBox["1", "x"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "w"}], ")"}]}], "-", 
        RowBox[{"u", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["x", "y"], "+", 
           FractionBox["y", "x"]}], ")"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"x", "-", 
           FractionBox["1", "x"]}], ")"}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8556297786512136`*^9, 3.855629846979082*^9}, {
   3.855629877881896*^9, 3.855630061498157*^9}, {3.855630138260198*^9, 
   3.8556301668256187`*^9}, 3.85563022282222*^9, 3.855630265656658*^9, 
   3.8556465965316267`*^9, {3.855646680202776*^9, 3.855646861887829*^9}, {
   3.8556469347845182`*^9, 3.855646974723514*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"93050d86-4d72-4a1c-adf7-274fe3da0e2e"],

Cell[BoxData[
 TemplateBox[{
  "Set", "write", 
   "\"Tag \\!\\(\\*RowBox[{\\\"And\\\"}]\\) in \\!\\(\\*RowBox[{RowBox[{\\\"z\
\\\", \\\"\[Equal]\\\", FractionBox[\\\"y\\\", \\\"x\\\"]}], \\\"&&\\\", \
RowBox[{RowBox[{FractionBox[\\\"1\\\", \\\"2\\\"], \\\" \\\", \\\"u\\\", \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{FractionBox[\\\"y\\\", \
SuperscriptBox[\\\"z\\\", \\\"2\\\"]], \\\"-\\\", FractionBox[SuperscriptBox[\
\\\"z\\\", \\\"2\\\"], \\\"y\\\"]}], \\\")\\\"}]}], \\\"\[Equal]\\\", \
RowBox[{RowBox[{FractionBox[\\\"1\\\", \\\"2\\\"], \\\" \\\", RowBox[{\\\"(\\\
\", RowBox[{\\\"x\\\", \\\"-\\\", RowBox[{\\\"1\\\", \\\" \\\", \
RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\")\\\"}], \\\" \\\", RowBox[{\
\\\"(\\\", RowBox[{\\\"u\\\", \\\"+\\\", \\\"w\\\"}], \\\")\\\"}]}], \
\\\"-\\\", RowBox[{\\\"u\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"y\\\", \\\" \\\", RowBox[{\\\"Power\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]}], \\\"-\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}], \\\"+\\\", RowBox[{FractionBox[\\\"1\\\", \\\"2\\\"], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{\\\"x\\\", \\\"+\\\", FractionBox[\\\"1\\\", \\\"x\
\\\"]}], \\\")\\\"}]}]}]}], \\\"&&\\\", \
RowBox[{RowBox[{FractionBox[\\\"1\\\", \\\"2\\\"], \\\" \\\", \\\"u\\\", \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{FractionBox[SuperscriptBox[\\\"z\\\", \
\\\"2\\\"], \\\"y\\\"], \\\"+\\\", FractionBox[\\\"y\\\", \
SuperscriptBox[\\\"z\\\", \\\"2\\\"]]}], \\\")\\\"}]}], \\\"-\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"u\\\"}]}]}]\\) is Protected.\"", 2, 7, 21, 
   32675132180409562874, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8556301434793053`*^9, 3.8556301703809357`*^9}, 
   3.855630228880145*^9, 3.855630269394433*^9, {3.8556469388801622`*^9, 
   3.8556469794223747`*^9}},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"76848b50-b34e-40c9-90b5-6e87cd363616"],

Cell[BoxData[
 TemplateBox[{
  "Solve", "svars", 
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"", 2,
    7, 22, 32675132180409562874, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.8556301434793053`*^9, 3.8556301703809357`*^9}, 
   3.855630228880145*^9, 3.855630269394433*^9, {3.8556469388801622`*^9, 
   3.8556469794903927`*^9}},
 CellLabel->
  "During evaluation of \
In[7]:=",ExpressionUUID->"a1fea002-849d-441c-8585-00ebb32fa34d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"y", "\[Rule]", 
    FractionBox[
     RowBox[{"0.25`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1.`"}], "+", 
        RowBox[{"1.`", " ", "u"}], "+", 
        RowBox[{"1.`", " ", "w"}], "+", 
        RowBox[{"1.`", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"1.`", " ", "u", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"1.`", " ", "w", " ", 
         SuperscriptBox["x", "2"]}], "+", 
        RowBox[{"1.`", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "16.`"}], " ", 
            SuperscriptBox["u", "2"], " ", 
            SuperscriptBox["x", "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1.`"}], "+", "u", "+", "w", "+", 
              SuperscriptBox["x", "2"], "+", 
              RowBox[{"u", " ", 
               SuperscriptBox["x", "2"]}], "+", 
              RowBox[{"w", " ", 
               SuperscriptBox["x", "2"]}]}], ")"}], "2"]}]]}]}], ")"}]}], 
     "u"]}], ",", 
   RowBox[{"y", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"0.25`", " ", 
       RowBox[{"(", 
        RowBox[{"1.`", "\[VeryThinSpace]", "-", 
         RowBox[{"1.`", " ", "u"}], "-", 
         RowBox[{"1.`", " ", "w"}], "-", 
         RowBox[{"1.`", " ", 
          SuperscriptBox["x", "2"]}], "-", 
         RowBox[{"1.`", " ", "u", " ", 
          SuperscriptBox["x", "2"]}], "-", 
         RowBox[{"1.`", " ", "w", " ", 
          SuperscriptBox["x", "2"]}], "+", 
         SqrtBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", "16.`"}], " ", 
            SuperscriptBox["u", "2"], " ", 
            SuperscriptBox["x", "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1.`"}], "+", "u", "+", "w", "+", 
              SuperscriptBox["x", "2"], "+", 
              RowBox[{"u", " ", 
               SuperscriptBox["x", "2"]}], "+", 
              RowBox[{"w", " ", 
               SuperscriptBox["x", "2"]}]}], ")"}], "2"]}]]}], ")"}]}], 
      "u"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.855630014360552*^9, {3.855630058819943*^9, 3.855630064795066*^9}, {
   3.855630120446751*^9, 3.855630169686082*^9}, 3.85563022791229*^9, 
   3.855630268692115*^9, {3.855646938965332*^9, 3.85564697951926*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"5d78b073-9477-484d-a409-d49b28b917bf"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
SpellingDictionaries->{"CorrectWords"->{
 "condition", "Calcyulate", "stage", "from", "initial", "Calculate"}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"7b22b033-644d-48c2-88e7-9a501821f9ef"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 585, 7, 51, "Subsection",ExpressionUUID->"461778f0-a5fe-4d24-b761-1aa424940857"],
Cell[CellGroupData[{
Cell[1190, 33, 2655, 56, 80, "Input",ExpressionUUID->"cd5c42cf-cee7-4867-857a-29bf95eb264f"],
Cell[3848, 91, 2184, 51, 50, "Output",ExpressionUUID->"213b9ab9-98c6-4776-a467-1035a0033488"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6069, 147, 1002, 29, 30, "Input",ExpressionUUID->"777838e7-968a-4783-9ec0-a799c687cf0f"],
Cell[7074, 178, 1267, 35, 50, "Output",ExpressionUUID->"dc89247c-0ef0-49b6-825a-e10583d5334e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8390, 219, 393, 7, 54, "Subsection",ExpressionUUID->"fac48f80-e163-4ab5-ad36-365c614d5e30"],
Cell[CellGroupData[{
Cell[8808, 230, 2082, 51, 88, "Input",ExpressionUUID->"9b3a5a6d-b49a-44e4-b2a4-a8fb8e9241ed"],
Cell[10893, 283, 2139, 64, 50, "Output",ExpressionUUID->"aa8b1169-78b9-45db-bff3-1e9ae0878642"]
}, Open  ]],
Cell[13047, 350, 977, 30, 60, "Input",ExpressionUUID->"adbc8ed6-3a92-42a3-8833-19696b0688f6"],
Cell[14027, 382, 1088, 33, 60, InheritFromParent,ExpressionUUID->"9ab78482-05ec-47a7-8da0-83665b620c00"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15152, 420, 252, 4, 54, "Subsection",ExpressionUUID->"40a0242e-bc68-463b-ae15-092ddcf057d7"],
Cell[CellGroupData[{
Cell[15429, 428, 1586, 41, 44, "Input",ExpressionUUID->"4b51e8c3-25cf-49b2-8857-4d1b39241487"],
Cell[17018, 471, 1311, 39, 50, "Output",ExpressionUUID->"c887c275-a40a-47ed-8fe6-9f754d04a048"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18378, 516, 188, 3, 54, "Subsection",ExpressionUUID->"79891f49-26e2-41b8-abb7-da493c9e4a1c"],
Cell[CellGroupData[{
Cell[18591, 523, 4447, 123, 110, "Input",ExpressionUUID->"93050d86-4d72-4a1c-adf7-274fe3da0e2e"],
Cell[23041, 648, 2141, 34, 47, "Message",ExpressionUUID->"76848b50-b34e-40c9-90b5-6e87cd363616"],
Cell[25185, 684, 488, 11, 28, "Message",ExpressionUUID->"a1fea002-849d-441c-8585-00ebb32fa34d"],
Cell[25676, 697, 2506, 68, 61, "Output",ExpressionUUID->"5d78b073-9477-484d-a409-d49b28b917bf"]
}, Open  ]]
}, Open  ]]
}
]
*)

